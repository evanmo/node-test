<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title></title>
<meta name="description" content="">
<meta name="author" content="">
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="http://www.caratta.com/css/bootstrap.min.css">
<link rel="stylesheet" href="http://www.caratta.com/css/bootstrap-responsive.min.css">
<link rel="stylesheet" href="http://www.caratta.com/css/style.css">
<script src="http://www.caratta.com/js/libs/modernizr-2.5.3-respond-1.1.0.min.js"></script>
</head>
<body>
<div class="well">
<h1>Temp List - <span id="status"></span></h1>
<input type="text" name="str" value=""><br /><button class="btn btn-primary" id="add-temp">Add Temp</button>
<ul id="temp-list" style="margin-top:10px"></ul>
</div>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/libs/jquery-1.7.2.min.js"><\/script>')</script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.3.3/underscore-min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
var socket = io.connect('http://node.caratta.com:1337');
socket.on('hello', function (data) {
  $('#status').text(data.word);
});
socket.on('add-string', function (data) {
  tempview.add_list(data.word);
  
});
//(function($){
var Temp = Backbone.Model.extend({
    defaults: {
       word: "Not specified"
    }
});

var Temps = Backbone.Collection.extend({
    model:Temp,
    initialize:function(){

    }
});

var TempView = Backbone.View.extend({
    el:$('.well'),
    initialize:function(){
       this.collection = new Temps();
       this.collection.on('add',this.add);
    },
    events:{
       "click #add-temp":  "add_temp"
    },
    add_temp:function(){
       var word = $.trim($('input[name="str"]').val());
       if(word){
          var newTemp = new Temp({ word:word});
          this.collection.add(newTemp);
          socket.emit('add-string', { word:word });
       }
    },
    add:function(model){
       var index = this.indexOf(model);
       $("#temp-list").append("<li>" + model.get('word') + " <button class='btn btn-danger delete'>Delete Temp</button></li>");      
    },
    add_list:function(word){
       $("#temp-list").append("<li>" + word + "</li>"); 
   }
});

tempview = new TempView;

//})(jQuery);
</script>
</body>
</html>
